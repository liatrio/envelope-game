apiVersion: skaffold/v2beta8
kind: Config	
build:
  artifacts:
  - image: envelope-game
  local: {}
deploy:
  helm:
    releases:
    - name: envelope-game
      chartPath: ./charts/envelope-game
      artifactOverrides:
        image.name: envelope-game
      setValueTemplates:
        ingress.hosts[0].host: "{{ .INGRESS_HOST }}" 
        ingress.hosts[0].paths[0]: /
portForward:
- resourceType: service
  resourceName: envelope-game
  port: 80
  localPort: 8080
profiles:
- name: local
  activation:
  - kubeContext: docker-desktop
  patches:
  - op: add
    path: /deploy/helm/releases/0/setValues
    value:
      nodeEnv: development
      ingress:
        enabled: false
      mysql:
        master:
          persistence:
            enabled: false
